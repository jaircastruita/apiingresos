# https://towardsdatascience.com/working-with-apis-using-flask-flask-restplus-and-swagger-ui-7cf447deda7f

from flask import Flask, request
from flask_restx import Api, Resource, fields

app = Flask(__name__)
api = Api(app=app, 
          version="0.1", 
          title="Endpoint inferencia de ingresos", 
          description="Calcula el ingreso de un cliente dada informacion proporcionada por el BC")

# prediction_space = app.namespace('predict', description='Predicts an income score given a feature vector')
model_fields = api.model('Name Model', 
                        {'Avg_hC_R_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Avg_lc_sm2_12m_o': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Avg_lc_sm2_12m_u': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Avg_meses_cta': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Avg_meses_cta_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Avg_saldo': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Avg_saldo_R_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'AvghC_avglc_R_util': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'EDAD_N': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Flag_auto': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Flag_hipo': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Flag_nomina': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Flag_producto': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Flag_tdc': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'HghC_r_sldo_R_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'HghC_r_sldo_o': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'HghC_r_sldo_u': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'HghC_sldo_R_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'HghC_smlc_R_util': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Ldis_sdo_act_R_tot': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Limcred_sm2_R_12_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'LmCrd_Smpagos_0': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Lna_disp_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Lna_disp_util': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'MaxHghC_smlc_R_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'MaxHghC_smlc_R_tot': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Max_Timsdo0_HIPO': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Max_Timsdo0_TDC_close': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Maxlc_Minlc': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Maxlc_Minlc_o': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Maxlc_Minlc_u': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'N_SOLICITUD': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'NcLimcred_sm2_12_o': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'NcLimcred_sm2_24': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Nc_R_util': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'NormaE12': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'NormaE6_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'NormaE_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'NormaE_util': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'PDER_ISTE': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'PDER_ISTEE': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'SEXO_N': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'Sldo_e_sldomx_R_tot': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'banderaAuto': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'banderaHipo': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'banderapers': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'banderatdc': fields.Integer(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_P12A14NOAF': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_P15PRI_INM': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_P15SEC_INF': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_P3A5_NOA_F': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_PDER_SEGP': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_PSINDER': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_VPH_2CUART': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_VPH_AGUAFV': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'cv_VPH_PISOTI': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_GRAPROES_M': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_PCLIM_MEN2': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_PDER_ISTE': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_P_60YMAS': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_edad_TDC': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_high_cred_NOM': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_high_cred_TDC': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_lim_cred_NOM': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_lim_cred_R_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_lim_cred_R_tot': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_lim_cred_TDC_close': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_lim_cred_TDC_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_lim_cred_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_max_cred': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_max_cred_R_tot': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_max_cred_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'max_pago_util': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mdian_lc': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mdian_lc_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mdian_lc_util': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mean_GRAPROES_F': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mean_PCLIM_MOT2': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mean_PDER_ISTE': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mean_PDESOCUP_F': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mean_POTRAS_REL': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'mean_PSIN_RELIG': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'meses_ctas_TDC_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'min_edad_NOM': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'min_edad_NOM_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'min_lim_cred': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'min_lim_cred_R_tot': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'saldo_act': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'saldo_act_open': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'smHb_r_smldo_TDC_close': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'sm_hb_HIPO': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'sm_pag_min_R_tot': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'sm_sld_act_TDC': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'std_GRAPROES_M': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'std_VPH_1CUART': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled."),
                            'sum_pag_edad_u': fields.Float(required = True, 
                                                        description="To be filled", 
                                                        help="To be filled.")
                            }
                  )

@api.route("/predict")
class IncomeRegressor(Resource):
    def get(self):
        pass
    
    @api.expect(model_fields, validate=True)
    # @api.marshal_with(model_fields, code=200)
    def post(self):
        return {
                "status": "Success", 
                "score": 0.5}

if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=True)